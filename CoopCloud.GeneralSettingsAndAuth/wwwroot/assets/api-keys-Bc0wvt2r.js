import{R as l,t as e,w as _}from"./index-BjhtngU2.js";import{w as y,y as k,au as F,I as w,aA as N,aB as E,aC as S,aD as R,aE as T,aF as V,aG as M,aH as O,aI as B,B as g,aJ as L,K as d,aw as G,ax as j,aK as $,ao as q,ay as z,az as J,aL as Y}from"./index-BzCiW6fY.js";import{A as h,S as Q,I as U}from"./status-badge-C4aKdise.js";import"./auth-api-Cs431hdg.js";import{u as W}from"./use-confirm-BdUb-5z8.js";import{s as X,a as Z}from"./vest-DWm3oUc2.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ee=y("circle-alert",H);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],te=y("copy",ae);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],re=y("power",se),A={name:"",description:"",statusId:h},ne=({onHide:t,onSubmitSuccess:s,...i})=>{const n=k({defaultValues:A,resolver:X(Z)}),{reset:r}=n,c=l.useCallback(()=>{r(A)},[r]);return e.jsx(F,{...i,modal:!0,form:n,noFixedHeight:!0,submitLabel:"Generar API Key",title:"Generar nueva API Key",subtitle:"Esta llave permitirá acceso administrativo a la API.",onHide:()=>{c(),t==null||t()},onSubmit:u=>{s==null||s(u),c(),t==null||t()},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{name:"name",label:"Nombre de la llave",placeholder:"Ej: Integración Facturación"}),e.jsx(N,{rows:3,name:"description",label:"Descripción",placeholder:"Descripción opcional de la llave..."})]})})},oe=({apiKey:t,onClose:s})=>{const i=()=>{t&&(navigator.clipboard.writeText(t),d.success("API Key copiada al portapapeles"))};return e.jsx(E,{open:!!t,onOpenChange:n=>!n&&s(),children:e.jsxs(S,{className:"sm:max-w-[500px]",children:[e.jsxs(R,{children:[e.jsx(T,{children:"API Key generada exitosamente"}),e.jsx(V,{children:"Guarda esta llave en un lugar seguro."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(M,{className:"border-none bg-red-600/10 text-red-600 dark:bg-red-400/10 dark:text-red-400",children:[e.jsx(ee,{}),e.jsx(O,{children:"Información importante"}),e.jsx(B,{className:"text-red-600/80 dark:text-red-400/80",children:"Esta es la única vez que podrás ver esta llave. Asegúrate de copiarla ahora, ya que no podrás recuperarla después."})]}),e.jsx("div",{className:"rounded-md bg-muted p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"flex-1 font-mono text-sm bg-background p-3 rounded border break-all",children:t}),e.jsx(g,{size:"icon",variant:"outline",onClick:i,children:e.jsx(te,{className:"h-4 w-4"})})]})})]}),e.jsx(L,{children:e.jsx(g,{onClick:s,children:"Cerrar"})})]})})},ie=[{id:"1",statusId:h,name:"Servidor de Producción",createdAt:new Date("2024-01-15T10:00:00"),description:"Llave para el servidor de producción"},{id:"2",statusId:h,name:"Entorno de Pruebas",createdAt:new Date("2024-02-01T09:00:00")}],le=()=>{const{confirm:t}=W(),{setSearch:s,setFilters:i,setSorting:n,tableState:r,setPagination:c,setJoinOperator:u}=G([{desc:!0,id:"createdAt"}]),[m,b]=l.useState(ie),[f,p]=l.useState(null),[I,v]=l.useState(!1),K=a=>{const o={...a,createdAt:new Date,id:Math.random().toString()};b([o,...m]);const x=`sk_live_${Math.random().toString(36).substring(7)}`;p(x),d.success("API Key generada exitosamente")},C=a=>{b(m.map(o=>o.id===a.id?{...o,statusId:U}:o)),d.success("API Key desactivada")},D=async a=>{if(await t({variant:"destructive",cancelButton:"Cancelar",actionButton:"Regenerar",title:"Regenerar API Key",body:`¿Estás seguro de que deseas regenerar la API Key "${a.name}"? La llave anterior dejará de funcionar inmediatamente.`})){const x=`sk_live_${Math.random().toString(36).substring(7)}`;p(x),d.success("API Key regenerada exitosamente")}},P=l.useMemo(()=>[{id:"name",header:"Nombre",accessorKey:"name",enableColumnFilter:!0,meta:{label:"Nombre",variant:"text"},cell:({row:a})=>j(a.getValue("name"))},{id:"description",header:"Descripción",enableColumnFilter:!0,accessorKey:"description",meta:{variant:"text",label:"Descripción"},cell:({row:a})=>j(a.getValue("description"))},{id:"statusId",header:"Estado",enableSorting:!1,accessorKey:"statusId",enableColumnFilter:!0,meta:{options:[],label:"Estado",variant:"select"},cell:({row:a})=>e.jsx(Q,{value:a.getValue("statusId")})},{id:"createdAt",accessorKey:"createdAt",enableColumnFilter:!0,header:"Fecha de creación",meta:{variant:"date",label:"Fecha de creación"},cell:({row:a})=>$(a.getValue("createdAt")).format("L")}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(q,{title:"API Keys",subtitle:"Gestiona las llaves de acceso para la API pública.",actions:e.jsxs(g,{onClick:()=>v(!0),children:[e.jsx(z,{className:"h-4 w-4"}),"Nueva API Key"]})}),e.jsx(J,{data:m,columns:P,onSearch:s,onSorting:n,getRowId:a=>a.id,onPagination:c,sorting:r.sorting,onAdvancedFilters:i,searchValue:r.search,advancedFilters:r.filters,joinOperator:r.joinOperator,onJoinOperatorChange:u,actions:[{icon:re,label:"Desactivar",onClick:C},{icon:Y,label:"Regenerar token",onClick:D}]}),e.jsx(ne,{visible:I,onSubmitSuccess:K,onHide:()=>v(!1)}),e.jsx(oe,{apiKey:f,onClose:()=>p(null)})]})},ge=_(le);export{ge as default};
